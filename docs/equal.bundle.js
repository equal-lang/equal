var equal;(()=>{var t={960:(t,e,r)=>{"use strict";e.__esModule=!0,e.bigTokenType=e.BigToken=e.bigLexer=void 0;var n=r(957),i=r(737);e.bigLexer=function(t,e,r){for(var o=[],h=0,c=[],u=[],p=[],l=!1,f=!1;h<=t.length-1;){var v=t[h];"START_TAG_LEFT"==v.tokenType?(m(u),l&&d("Unterminated start tag",v.line),l=!0):"END_TAG_LEFT"==v.tokenType?(m(u),f&&d("Unterminated end tag",v.line),f=!0):"TAG_RIGHT"==v.tokenType?l&&f?d("Missing right tag",v.line):l||f?l?(E(c),l=!1):f&&(y(p),f=!1):d("Extra right tag",v.line):"EOF"==v.tokenType?m(u):l?c.push(v):f?p.push(v):u.push(v),h++}return(l||f)&&T("Unclosed tag",t[t.length-1].line),o;function E(t){if(0!=t.length){c=[];var e=t[0].value;e||d("Missing tagname",t[0].line);var r=s.get(e);if(null!=r){for(var n={},i=1,h="",u="";i<t.length;)t[i]&&"ATTRIBUTE"==t[i].tokenType&&r.includes(t[i].value)&&(h=t[i].value,t[++i]&&"EQUAL_SIGN"==t[i].tokenType?i++:d("Missing equal sign",t[i-1].line),t[i]&&"VALUE"==t[i].tokenType&&(null==t[i].value?d("Undefined value",t[i].line):u=t[i].value,i++),n[h]=u,h="",u="");o.push(new a("START_TAG",e,n,t[t.length-1].line))}}}function y(t){if(0!=t.length){p=[],t.length>1&&T("Extra attributes in end tag",t[0].line);var e=t[0].value;e||d("Missing tagname",t[0].line),o.push(new a("END_TAG",e,{},t[0].line))}}function m(t){if(0!=t.length){u=[],t.length>1&&T("Extra attributes in text",t[0].line);var e=t[0].value;void 0===e&&d("The value of a literal cannot be undefined",t[0].line),o.push(new a("TEXT",void 0,{value:(0,i.wrapValue)(e)},t[0].line))}}function d(t,r){throw new n.EqualSyntaxError(t,e,r)}function T(t,i){var o=new n.EqualSyntaxError(t,e,i);r.reportError(o)}};var o,s=(new Map).set("div",[]).set("h1",["class"]).set("h2",["class"]).set("h3",["class"]).set("h4",["class"]).set("h5",["class"]).set("h6",["class"]).set("p",["class"]).set("a",["id","href","class"]).set("input",["type","value","id"]).set("form",["title","id"]).set("label",["for"]).set("link",["rel","href","type"]).set("span",[]),a=function(t,e,r,n){this.type=t,this.name=e,this.attribute=r,this.line=n};e.BigToken=a,function(t){t.START_TAG="START_TAG",t.END_TAG="END_TAG",t.TEXT="TEXT"}(o||(o={})),e.bigTokenType=o},271:function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});e.__esModule=!0,e.returnVal=e.EqualFunction=e.isEqualCallable=void 0;var o=r(355);e.isEqualCallable=function(t){return void 0!==t.arity&&void 0!==t.call};var s=function(){function t(t){this.declaration=t}return t.prototype.arity=function(){return this.declaration.params.length},t.prototype.call=function(t,e){for(var r=new o.Environment(t.environment),n=0;n<=e.length-1;n++)r.assign(this.declaration.params[n],e[n]);try{t.publicExecBlock(this.declaration.body,r)}catch(t){return t.val}return 0},t}();e.EqualFunction=s;var a=function(t){function e(r){var n=t.call(this)||this;return Object.setPrototypeOf(n,e.prototype),n.name="returnVal",n.val=r,n}return i(e,t),e}(Error);e.returnVal=a},355:(t,e,r)=>{"use strict";e.__esModule=!0,e.Environment=void 0;var n=r(957),i=function(){function t(t){this.variables=new Map,this.functions=new Map,this.outerEnv=t}return t.prototype.assign=function(t,e){this.variables.set(t,e)},t.prototype.get=function(t){var e=this.variables.get(t);if(null==e&&null!=this.outerEnv&&(e=this.outerEnv.get(t)),null==e)throw new n.EqualRuntimeError("Undefined variable "+t);return e},t.prototype.declareFunc=function(t,e){this.functions.set(t,e)},t.prototype.getFunc=function(t){var e=this.functions.get(t);if(null==e)throw new n.EqualRuntimeError("Undeclared function "+t);return e},t}();e.Environment=i},957:function(t,e){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0,e.ErrorHandler=e.EqualUnexpectedError=e.EqualRuntimeError=e.EqualSyntaxError=e.EqualError=void 0;var i=function(){function t(){}return t.prototype.print=function(t){return t.accept(this)},t.prototype.visitSyntaxError=function(t){return"SyntaxError at "+this.toString(t)},t.prototype.visitRuntimeError=function(t){return"RuntimeError at "+this.toString(t)},t.prototype.visitUnexpectedError=function(t){return"Unexpected Error: "+t.message+"\nPlease report the bug at https://github.com/equal-lang/equal/issues\n(To view the stack trace, run the interpreter again in verbose mode)"},t.prototype.toString=function(t){return t.file+":"+t.line+": "+t.message},t}(),o=function(t){function e(r,n,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.name="EqualError",o.message=r,o.file=null==n?"Unknown":n,o.line=null==i?0:i,o}return n(e,t),e.prototype.accept=function(t){if(void 0===(e=t).visitSyntaxError||void 0===e.visitRuntimeError||void 0===e.visitUnexpectedError)throw new Error("Invalid visitor type");var e},e}(Error);e.EqualError=o;var s=function(t){function e(r,n,i){var o=t.call(this,r,n,i)||this;return Object.setPrototypeOf(o,e.prototype),o.name="EqualSyntaxError",o}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitSyntaxError(this)},e}(o);e.EqualSyntaxError=s;var a=function(t){function e(r,n,i){var o=t.call(this,r,n,i)||this;return Object.setPrototypeOf(o,e.prototype),o.name="EqualRuntimeError",o}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitRuntimeError(this)},e}(o);e.EqualRuntimeError=a;var h=function(t){function e(r,n,i){var o=t.call(this,r,n,i)||this;return Object.setPrototypeOf(o,e.prototype),o.name="EqualUnexpectedError",o}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitUnexpectedError(this)},e}(o);e.EqualUnexpectedError=h;var c=function(){function t(t){this.mode=t,this._hasError=!1,this.errors=[]}return t.prototype.getErrorStatus=function(){return this._hasError},t.prototype.reportError=function(t){console.error((new i).print(t)),this._hasError=!0,this.errors.push(t)},t.prototype.handleError=function(t){var e;"VERBOSE"==this.mode&&console.debug("Error",t),e=t instanceof o?t:new h(t.message),console.error((new i).print(e)),this._hasError=!0,this.errors.push(e)},t}();e.ErrorHandler=c},417:function(t,e){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});function i(t){return void 0!==t.visitBinary&&void 0!==t.visitLogical&&void 0!==t.visitUnary&&void 0!==t.visitLiteral&&void 0!==t.visitVariable&&void 0!==t.visitCall}e.__esModule=!0,e.Call=e.Variable=e.Literal=e.Unary=e.Logical=e.Binary=e.Expression=e.isExpressionVisitor=void 0,e.isExpressionVisitor=i;var o=function(){function t(){}return t.prototype.accept=function(t){if(!i(t))throw new Error("Invalid visitor type")},t}();e.Expression=o;var s=function(t){function e(e,r,n){var i=t.call(this)||this;return i.operator=e,i.arg1=r,i.arg2=n,i}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitBinary(this)},e}(o);e.Binary=s;var a=function(t){function e(e,r,n){var i=t.call(this)||this;return i.operator=e,i.arg1=r,i.arg2=n,i}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitLogical(this)},e}(o);e.Logical=a;var h=function(t){function e(e,r){var n=t.call(this)||this;return n.operator=e,n.arg1=r,n}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitUnary(this)},e}(o);e.Unary=h;var c=function(t){function e(e){var r=t.call(this)||this;return r.arg=e,r}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitLiteral(this)},e}(o);e.Literal=c;var u=function(t){function e(e){var r=t.call(this)||this;return r.name=e,r}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitVariable(this)},e}(o);e.Variable=u;var p=function(t){function e(e,r){var n=t.call(this)||this;return n.calleeName=e,n.args=r,n}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitCall(this)},e}(o);e.Call=p},40:(t,e,r)=>{"use strict";e.__esModule=!0,e.Interpreter=void 0;var n=r(957),i=r(355),o=r(271),s=function(){function t(t,e,r,n){this.mode=t,this.errHandler=e,this.pointer=0;var o=new i.Environment;this.environment=o,this.global=o,this.printer=r,this.input=n}return t.prototype.interpret=function(t,e){for(this.path=e,this.statements=t,"VERBOSE"==this.mode&&console.debug("Statements",this.statements);!(this.pointer>this.statements.length-1);){var r=this.statements[this.pointer];this.exec(r),this.pointer++}"VERBOSE"==this.mode&&console.debug("GlobalEnvironment",this.environment)},t.prototype.visitBinary=function(t){var e=this.eval(t.arg1),r=this.eval(t.arg2);switch(t.operator){case"EQUAL":return e===r;case"NOT_EQUAL":return e!==r;case"GREATER_THAN":return this.checkType(e,["number"]),this.checkType(r,["number"]),e>r;case"LESSER_THAN":return this.checkType(e,["number"]),this.checkType(r,["number"]),e<r;case"PLUS":return this.checkType(e,["number"]),this.checkType(r,["number"]),e+r;case"MINUS":return this.checkType(e,["number"]),this.checkType(r,["number"]),e-r;case"MULTIPLY":return this.checkType(e,["number"]),this.checkType(r,["number"]),e*r;case"DIVIDE":if(this.checkType(e,["number"]),this.checkType(r,["number"]),0==r)throw new n.EqualRuntimeError("Division by zero",this.path);return e/r;default:throw new n.EqualRuntimeError("Binary operator does not exist",this.path)}},t.prototype.visitLogical=function(t){var e,r=this.eval(t.arg1);switch(t.operator){case"AND":return this.checkType(r,["boolean"]),!0===r&&(e=this.eval(t.arg2),this.checkType(e,["boolean"]),e);case"OR":return this.checkType(r,["boolean"]),!1!==r||(e=this.eval(t.arg2),this.checkType(e,["boolean"]),e);default:throw new n.EqualRuntimeError("Logical operator does not exist",this.path)}},t.prototype.visitUnary=function(t){var e=this.eval(t.arg1);if("NOT"===t.operator)return this.checkType(e,["boolean"]),!e;throw new n.EqualRuntimeError("Operator does not exist",this.path)},t.prototype.visitCall=function(t){var e=this.global.getFunc(t.calleeName);if(!(0,o.isEqualCallable)(e))throw new n.EqualRuntimeError("Object is not callable",this.path);for(var r=[],i=0;i<=t.args.length-1;i++){var s=this.eval(t.args[i]);this.checkType(s,["string","number","boolean"]),r.push(s)}if(r.length!=e.arity())throw new n.EqualRuntimeError("Expected "+e.arity()+" arguments, got "+r.length);return e.call(this,r)},t.prototype.visitLiteral=function(t){return this.checkType(t.arg,["string","number","boolean"]),t.arg},t.prototype.visitVariable=function(t){return this.environment.get(t.name)},t.prototype.visitScope=function(t){this.execBlock(t.statements,new i.Environment(this.environment))},t.prototype.visitAssignment=function(t){"global"==t.scope?this.global.assign(t.name,this.eval(t.expression)):this.environment.assign(t.name,this.eval(t.expression))},t.prototype.visitFunctionDeclaration=function(t){var e=new o.EqualFunction(t);this.global.declareFunc(t.name,e)},t.prototype.visitReturnStatement=function(t){if(this.environment==this.global)throw new n.EqualRuntimeError("No return statement allowed in global scope",this.path);throw new o.returnVal(this.eval(t.expression))},t.prototype.visitExpressionStatement=function(t){this.eval(t.expression)},t.prototype.visitConditionalStatement=function(t){for(var e=-1,r=0;r<t.conditions.length;r++)if(!0===this.eval(t.conditions[r])){e=r;break}if(-1==e&&t.statements.length==t.conditions.length+1&&(e=t.statements.length-1),-1!=e)for(var n=0;n<=t.statements[e].length-1;n++)this.exec(t.statements[e][n])},t.prototype.visitLoop=function(t){for(var e=this.eval(t.condition);!0===e;){for(var r=0;r<=t.statements.length-1;r++)this.exec(t.statements[r]);e=this.eval(t.condition)}},t.prototype.visitPrintStatement=function(t){for(var e=0;e<=t.expressions.length-1;e++)this.printer.print(this.eval(t.expressions[e]))},t.prototype.eval=function(t){return t.accept(this)},t.prototype.exec=function(t){return t.accept(this)},t.prototype.execBlock=function(t,e){var r=this.environment;this.environment=e;try{for(var n=0;n<=t.length-1;n++)this.exec(t[n])}catch(t){throw t}finally{this.environment=r}},t.prototype.checkType=function(t,e){for(var r=0,i=e;r<i.length;r++)if(typeof t==i[r])return!0;throw new n.EqualRuntimeError("Unexpected type "+typeof t,this.path)},t.prototype.publicExecBlock=function(t,e){return this.execBlock(t,e)},t}();e.Interpreter=s},881:(t,e,r)=>{"use strict";e.__esModule=!0,e.Lexer=void 0;var n=r(78),i=r(957),o=function(){function t(t,e){this.mode=t,this.errHandler=e,this.source="",this.line=1,this.tokens=[],this.leftPointer=0,this.rightPointer=0}return t.prototype.lex=function(t,e){var r=this;this.source=t,this.path=e;for(var n=!1;!this.atEnd();){var i=this.source[this.rightPointer];switch(this.leftPointer=this.rightPointer,i){case"<":this.condForward("!--",3)?(this.rightPointer++,this.comment()):(this.condForward("/")?this.pushToken("END_TAG_LEFT"):this.pushToken("START_TAG_LEFT"),n=!0,this.rightPointer++,this.tagname());break;case">":this.pushToken("TAG_RIGHT"),n=!1;break;case"=":n&&(this.pushToken("EQUAL_SIGN"),this.rightPointer++,this.value());break;case"/":n&&">"==this.lookAhead()&&this.rightPointer++;break;case"\n":this.line++;break;case" ":case"\t":case"\r":break;default:n?this.pushToken("ATTRIBUTE",this.consumeWhile((function(t){return"="!=t&&!r.endOfTag(t)&&!r.isWhitespace(t)}))):this.pushToken("TEXT",this.consumeWhile((function(t){return"<"!=t})).trim())}this.rightPointer++}return this.pushToken("EOF"),this.tokens},t.prototype.tagname=function(){var t=this;this.pushToken("TAGNAME",this.consumeWhile((function(e){return!t.isWhitespace(e)&&!t.endOfTag(e)})))},t.prototype.value=function(){var t,e=this,r=this.source[this.rightPointer];this.isWhitespace(r)&&(this.consumeWhile((function(t){return e.isWhitespace(t)})),this.rightPointer++,r=this.source[this.rightPointer]),'"'==r?(this.rightPointer++,t=this.consumeWhile((function(t){return'"'!=t})),this.rightPointer++):"'"==r?(this.rightPointer++,t=this.consumeWhile((function(t){return"'"!=t})),this.rightPointer++):t=this.consumeWhile((function(t){return!e.isWhitespace(t)&&!e.endOfTag(t)})),this.pushToken("VALUE",t)},t.prototype.comment=function(){var t=this;this.consumeWhile((function(e){return!("-"==e&&t.condForward("->",2))})),this.rightPointer++},t.prototype.handleNewline=function(){var t=this.source[this.rightPointer];"\r"==t&&this.line++,"\n"==t&&"\r"!=this.lookBehind()&&this.line++},t.prototype.consumeWhile=function(t){this.leftPointer=this.rightPointer;for(var e=this.source[this.rightPointer],r=t(e);!this.atEnd()&&r;)this.handleNewline(),this.rightPointer++,r=t(e=this.source[this.rightPointer]);var n=this.source.slice(this.leftPointer,this.rightPointer);return this.rightPointer--,n},t.prototype.condForward=function(t,e){return void 0===e&&(e=1),!this.atEnd(e)&&t==this.source.slice(this.rightPointer+1,this.rightPointer+e+1)&&(this.rightPointer+=e,!0)},t.prototype.lookAhead=function(t){return void 0===t&&(t=1),this.atEnd(t)?"":this.source.slice(this.rightPointer+1,this.rightPointer+t+1)},t.prototype.lookBehind=function(){return this.atEnd(-1)?"":this.source[this.rightPointer-1]},t.prototype.atEnd=function(t){return void 0===t&&(t=0),this.rightPointer+t>this.source.length-1},t.prototype.isWhitespace=function(t){return" "==t||"\t"==t||"\r"==t},t.prototype.endOfTag=function(t){return">"==t||"/"==t&&">"==this.lookAhead()},t.prototype.pushToken=function(t,e){this.tokens.push(new n.Token(t,this.line,e))},t.prototype.reportError=function(t){var e=new i.EqualSyntaxError(t,this.path,this.line);this.errHandler.reportError(e)},t}();e.Lexer=o},113:(t,e,r)=>{"use strict";e.__esModule=!0,e.Parser=void 0;var n=r(78),i=r(957),o=r(417),s=r(540),a=r(960),h=function(){function t(t,e){this.mode=t,this.errHandler=e,this.pointer=0,this.statements=[]}return t.prototype.parse=function(t,e){for(this.path=e,this.tokens=(0,a.bigLexer)(t,this.path,this.errHandler),"VERBOSE"==this.mode&&console.debug("bigTokens",this.tokens);!this.atEnd();)this.statements.push(this.statement());return this.statements},t.prototype.statement=function(){return this.scope()},t.prototype.scope=function(){if(this.match("START_TAG","div",{})){for(var t=[];!this.match("END_TAG","div",{});)t.push(this.statement());return new s.Scope(t)}return this.assignment()},t.prototype.assignment=function(){var t=this;if(this.match("START_TAG","a",{})){var e=this.retPrevAttrE("id"),r="global"==this.retPrevAttr("class")?"global":void 0;this.checkString(e,"a id");var n=this.expression();return this.force((function(){return t.match("END_TAG","a",{})})),new s.Assignment(e,n,r)}return this.functionDeclaration()},t.prototype.functionDeclaration=function(){var t=this;if(this.match("START_TAG","form",{id:void 0})){var e=this.retPrevAttrE("id");this.checkString(e,"function name");for(var r=[];this.match("START_TAG","input",{});){var n=this.retPrevAttrE("id");this.checkString(n,"input id"),r.push(n)}var i=[];for(this.force((function(){return t.match("START_TAG","div",{})}));!this.match("END_TAG","div",{});)i.push(this.statement());return this.force((function(){return t.match("END_TAG","form",{})})),new s.FunctionDeclaration(e,r,i)}return this.returnStatement()},t.prototype.returnStatement=function(){return this.match("START_TAG","input",{type:["submit"]})?new s.ReturnStatement(this.expression()):this.loop()},t.prototype.loop=function(){if(this.match("START_TAG","p",{})){for(var t=[],e=this.expression();!this.match("END_TAG","p",{});)t.push(this.statement());return new s.Loop(e,t)}return this.conditionalStatement()},t.prototype.conditionalStatement=function(){if(this.match("START_TAG","h1",{})){for(var t=[],e=[],r=[],n=this.expression();!this.match("END_TAG","h1",{});)r.push(this.statement());t.push(r),e.push(n);for(var i=2;i<=5;i++)if(this.match("START_TAG","h"+i,{})){for(n=this.expression(),r=[];!this.match("END_TAG","h"+i,{});)r.push(this.statement());t.push(r),e.push(n)}if(this.match("START_TAG","h6",{})){for(r=[];!this.match("END_TAG","h6",{});)r.push(this.statement());t.push(r)}return new s.ConditionalStatement(e,t)}return this.printStatement()},t.prototype.printStatement=function(){var t=[];if(this.match("START_TAG","span",{})){for(;!this.match("END_TAG","span",{});)t.push(this.expression());return new s.PrintStatement(t)}return this.expressionStatement()},t.prototype.expressionStatement=function(){return new s.ExpressionStatement(this.expression())},t.prototype.expression=function(){return this.logic()},t.prototype.logic=function(){return this.retNestedLogicalExpr(["&&","||"],this.equality.bind(this))},t.prototype.equality=function(){return this.retBinaryExpr(["==","!="],this.comparsion.bind(this))},t.prototype.comparsion=function(){return this.retBinaryExpr([">","<"],this.addition.bind(this))},t.prototype.addition=function(){return this.retNestedBinaryExpr(["+","-"],this.multiplication.bind(this))},t.prototype.multiplication=function(){return this.retNestedBinaryExpr(["*","/"],this.unary.bind(this))},t.prototype.unary=function(){if(this.matchStartForm(["!"])){var t=this.retOperator();this.force(this.matchStartLabel);var e=this.expression();return this.force(this.matchEndLabel),this.force(this.matchEndForm),new o.Unary(t,e)}return this.call()},t.prototype.call=function(){if(this.match("START_TAG","form",{})){var t=this.retPrevAttrE("title");this.checkString(t,"callee name");var e=[];if(this.matchStartLabel())for(;!this.matchEndLabel();){var r=this.expression();e.push(r)}return this.force(this.matchEndForm),new o.Call(t,e)}return this.primary()},t.prototype.primary=function(){var t=this;if(this.matchText())return new o.Literal(this.retPrevAttrE("value"));this.force((function(){return t.match("START_TAG","a",{})}));var e=this.retPrevAttrE("href");return this.checkString(e,"a href"),this.force((function(){return t.match("END_TAG","a",{})})),new o.Variable(e)},t.prototype.retBinaryExpr=function(t,e){if(this.matchStartForm(t)){var r=this.retOperator();this.force(this.matchStartLabel);var n=this.expression();this.force(this.matchEndLabel),this.force(this.matchStartLabel);var i=this.expression();return this.force(this.matchEndLabel),this.force(this.matchEndForm),new o.Binary(r,n,i)}return e()},t.prototype.retNestedExpr=function(t,e,r){if(this.matchStartForm(t)){var n=this.retOperator();this.force(this.matchStartLabel);var i=this.expression();this.force(this.matchEndLabel),this.force(this.matchStartLabel);var o=this.expression();this.force(this.matchEndLabel);for(var s=new r(n,i,o);this.matchStartLabel();)s=new r(n,s,this.expression()),this.force(this.matchEndLabel);return this.force(this.matchEndForm),s}return e()},t.prototype.retNestedBinaryExpr=function(t,e){return this.retNestedExpr(t,e,o.Binary)},t.prototype.retNestedLogicalExpr=function(t,e){return this.retNestedExpr(t,e,o.Logical)},t.prototype.match=function(t,e,r){var n;if(this.atEnd())return!1;if((n=this.tokens[this.pointer]).type===t&&n.name===e){for(var i in r)if(null==r[i]){if(!n.attribute[i])return!1}else if(!r[i].includes(n.attribute[i]))return!1;return this.pointer++,!0}return!1},t.prototype.matchStartForm=function(t){return this.match("START_TAG","form",{title:t})},t.prototype.matchStartLabel=function(){return this.match("START_TAG","label",{})},t.prototype.matchText=function(){return this.match("TEXT",void 0,{})},t.prototype.matchEndLabel=function(){return this.match("END_TAG","label",{})},t.prototype.matchEndForm=function(){return this.match("END_TAG","form",{})},t.prototype.force=function(t){if(!t.bind(this)()){this.pointer>this.tokens.length-1&&this.throwError("Unexpected EOF",this.tokens[this.tokens.length-1].line);var e,r=this.tokens[this.pointer];e="START_TAG"==r.type?"start "+r.name:"END_TAG"==r.type?"end "+r.name:"text",this.throwError("Unexpected "+e,this.tokens[this.pointer].line)}return!0},t.prototype.retPrevAttr=function(t){return this.tokens[this.pointer-1].attribute[t]},t.prototype.retPrevAttrE=function(t){var e=this.retPrevAttr(t);return void 0===e&&this.throwError("Value of attribute "+t+" cannot be undefined",this.tokens[this.pointer-1].line),e},t.prototype.retOperator=function(){var t=n.operatorMap.get(this.retPrevAttrE("title"));return void 0===t&&this.throwError("Operator cannot be undefined",this.tokens[this.pointer].line),t},t.prototype.atEnd=function(t){return void 0===t&&(t=0),this.pointer+t>this.tokens.length-1},t.prototype.checkString=function(t,e){"string"!=typeof t&&this.throwError("String value expected for "+e,this.tokens[this.pointer].line)},t.prototype.throwError=function(t,e){throw new i.EqualSyntaxError(t,this.path,e)},t.prototype.reportError=function(t,e){this.errHandler.reportError(new i.EqualSyntaxError(t,this.path,e))},t}();e.Parser=h},955:(t,e)=>{"use strict";e.__esModule=!0,e.Printer=void 0;var r=function(){function t(t){this.buffer="",this.allText="",this.outputMethod=t||console.log}return t.prototype.print=function(t){this.outputMethod(t),this.allText+=t+"\n"},t.prototype.bufferedPrint=function(t){this.buffer+=t+"\n"},t.prototype.flushBuffer=function(){this.buffer&&("\n"==this.buffer[this.buffer.length-1]&&(this.buffer=this.buffer.slice(0,this.buffer.length-1)),this.outputMethod(this.buffer))},t.prototype.allPrinted=function(){return"\n"==this.allText[this.allText.length-1]&&(this.allText=this.allText.slice(0,this.allText.length-1)),this.allText},t}();e.Printer=r},540:function(t,e){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});function i(t){return void 0!==t.visitScope&&void 0!==t.visitAssignment&&void 0!==t.visitLoop&&void 0!==t.visitConditionalStatement&&void 0!==t.visitExpressionStatement&&void 0!==t.visitPrintStatement&&void 0!==t.visitFunctionDeclaration&&void 0!==t.visitReturnStatement}e.__esModule=!0,e.ReturnStatement=e.FunctionDeclaration=e.PrintStatement=e.ExpressionStatement=e.ConditionalStatement=e.Loop=e.Assignment=e.Scope=e.Statement=e.isStatementVisitor=void 0,e.isStatementVisitor=i;var o=function(){function t(){}return t.prototype.accept=function(t){if(!i(t))throw new Error("Invalid visitor type")},t}();e.Statement=o;var s=function(t){function e(e){var r=t.call(this)||this;return r.statements=e,r}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitScope(this)},e}(o);e.Scope=s;var a=function(t){function e(e,r,n){var i=t.call(this)||this;return i.name=e,i.expression=r,i.scope=n,i}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitAssignment(this)},e}(o);e.Assignment=a;var h=function(t){function e(e,r){var n=t.call(this)||this;return n.condition=e,n.statements=r,n}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitLoop(this)},e}(o);e.Loop=h;var c=function(t){function e(e,r){var n=t.call(this)||this;return n.conditions=e,n.statements=r,n}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitConditionalStatement(this)},e}(o);e.ConditionalStatement=c;var u=function(t){function e(e){var r=t.call(this)||this;return r.expression=e,r}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitExpressionStatement(this)},e}(o);e.ExpressionStatement=u;var p=function(t){function e(e){var r=t.call(this)||this;return r.expressions=e,r}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitPrintStatement(this)},e}(o);e.PrintStatement=p;var l=function(t){function e(e,r,n){var i=t.call(this)||this;return i.name=e,i.params=r,i.body=n,i}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitFunctionDeclaration(this)},e}(o);e.FunctionDeclaration=l;var f=function(t){function e(e){var r=t.call(this)||this;return r.expression=e,r}return n(e,t),e.prototype.accept=function(e){return t.prototype.accept.call(this,e),e.visitReturnStatement(this)},e}(o);e.ReturnStatement=f},78:(t,e)=>{"use strict";var r;e.__esModule=!0,e.operatorMap=e.operatorType=e.tokenType=e.Token=void 0,function(t){t.START_TAG_LEFT="START_TAG_LEFT",t.END_TAG_LEFT="END_TAG_LEFT",t.TAG_RIGHT="TAG_RIGHT",t.EQUAL_SIGN="EQUAL_SIGN",t.TAGNAME="TAGNAME",t.ATTRIBUTE="ATTRIBUTE",t.TEXT="TEXT",t.VALUE="VALUE",t.DOCTYPE="DOCTYPE",t.EOF="EOF"}(r||(r={})),e.tokenType=r;var n;e.Token=function(t,e,r){this.tokenType=t,this.value=r,this.line=e},function(t){t.AND="AND",t.OR="OR",t.EQUAL="EQUAL",t.NOT_EQUAL="NOT_EQUAL",t.GREATER_THAN="GREATER_THAN",t.LESSER_THAN="LESSER_THAN",t.PLUS="PLUS",t.MINUS="MINUS",t.MULTIPLY="MULTIPLY",t.DIVIDE="DIVIDE",t.NOT="NOT"}(n||(n={})),e.operatorType=n;var i=(new Map).set("&&","AND").set("||","OR").set("==","EQUAL").set("!=","NOT_EQUAL").set(">","GREATER_THAN").set("<","LESSER_THAN").set("+","PLUS").set("-","MINUS").set("*","MULTIPLY").set("/","DIVIDE").set("!","NOT");e.operatorMap=i},737:(t,e)=>{"use strict";var r;e.__esModule=!0,e.wrapValue=e.equalMode=void 0,function(t){t.VERBOSE="VERBOSE",t.NORMAL="NORMAL"}(r||(r={})),e.equalMode=r,e.wrapValue=function(t){return isNaN(Number(t))?"true"===t||"false"==t?"true"===t:t:Number(t)}},456:()=>{}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,r),o.exports}var n={};(()=>{"use strict";var t=n;t.__esModule=!0,t.Equal=void 0;var e=r(456),i=r(881),o=r(113),s=r(40),a=r(957),h=r(955),c=function(){function t(t){var e=t.mode,r=void 0===e?"NORMAL":e,n=t.path,c=t.source,u=t.output,p=void 0===u?console.log:u,l=t.input;try{if(!n&&!c)throw new a.EqualRuntimeError("No source code found");c?this.source=c:n&&(this.source=this.loadFile(n)),this.path=null!=n?n:"Unknown",this.mode="VERBOSE"==r?"VERBOSE":"NORMAL",this.error=!1,this.printer=new h.Printer(p),this.errHandler=new a.ErrorHandler(this.mode),this.lexer=new i.Lexer(this.mode,this.errHandler),this.parser=new o.Parser(this.mode,this.errHandler),this.interpreter=new s.Interpreter(this.mode,this.errHandler,this.printer,l)}catch(t){this.errHandler.handleError(t)}}return t.prototype.run=function(){try{if(0==this.error){this.verbose("Running in verbose mode");var t=this.lexer.lex(this.source,this.path);this.verbose(t,"Tokens");var e=this.parser.parse(t,this.path);return this.error=this.errHandler.getErrorStatus(),this.execute(e,this.path),this.printer.allPrinted()}}catch(t){this.errHandler.handleError(t)}},t.prototype.loadFile=function(t){if(this.verbose("Loading file at "+this.path),!e.existsSync(t))throw new a.EqualRuntimeError("Invalid path");return e.readFileSync(t,"utf8")},t.prototype.execute=function(t,e){try{0==this.error?(this.interpreter.interpret(t,e),this.printer.flushBuffer()):this.verbose(this.errHandler.errors,"Errors")}catch(t){this.errHandler.handleError(t)}},t.prototype.verbose=function(t,e){"VERBOSE"==this.mode&&(e?console.debug(e,t):console.debug(t))},t}();t.Equal=c})(),equal=n})();